(function(){var a={version:"0.8.8",name:"PluginDetect",addPlugin:function(b,c){b&&a.isString(b)&&c&&a.isFunc(c.getVersion)&&(b=b.replace(/\s/g,"").toLowerCase(),a.Plugins[b]=c,a.isDefined(c.getVersionDone)||(c.installed=null,c.version=null,c.version0=null,c.getVersionDone=null,c.pluginName=b))},openTag:"<",hasOwnProperty:{}.constructor.prototype.hasOwnProperty,hasOwn:function(b,c){var d;try{d=a.hasOwnProperty.call(b,c)}catch(e){}return!!d},rgx:{str:/string/i,num:/number/i,fun:/function/i,arr:/array/i},toString:{}.constructor.prototype.toString,isDefined:function(a){return"undefined"!=typeof a},isArray:function(b){return a.rgx.arr.test(a.toString.call(b))},isString:function(b){return a.rgx.str.test(a.toString.call(b))},isNum:function(b){return a.rgx.num.test(a.toString.call(b))},isStrNum:function(b){return a.isString(b)&&/\d/.test(b)},isFunc:function(b){return a.rgx.fun.test(a.toString.call(b))},getNumRegx:/[\d][\d\.\_,\-]*/,splitNumRegx:/[\.\_,\-]/g,getNum:function(b,c){var d=a.isStrNum(b)?(a.isDefined(c)?RegExp(c):a.getNumRegx).exec(b):null;return d?d[0]:null},compareNums:function(b,c,d){var e=parseInt;if(a.isStrNum(b)&&a.isStrNum(c)){if(a.isDefined(d)&&d.compareNums)return d.compareNums(b,c);b=b.split(a.splitNumRegx);c=c.split(a.splitNumRegx);for(d=0;d<Math.min(b.length,c.length);d++){if(e(b[d],10)>e(c[d],10))return 1;if(e(b[d],10)<e(c[d],10))return-1}}return 0},formatNum:function(b,c){var d,e;if(!a.isStrNum(b))return null;a.isNum(c)||(c=4);c--;e=b.replace(/\s/g,"").split(a.splitNumRegx).concat(["0","0","0","0"]);for(d=0;4>d;d++)if(/^(0+)(.+)$/.test(e[d])&&(e[d]=RegExp.$2),d>c||!/\d/.test(e[d]))e[d]="0";return e.slice(0,4).join(",")},pd:{getPROP:function(b,c,d){try{b&&(d=b[c])}catch(e){}return d},findNavPlugin:function(b){if(b.dbug)return b.dbug;if(window.navigator){var c={Find:a.isString(b.find)?RegExp(b.find,"i"):b.find,Find2:a.isString(b.find2)?RegExp(b.find2,"i"):b.find2,Avoid:b.avoid?a.isString(b.avoid)?RegExp(b.avoid,"i"):b.avoid:0,Num:b.num?/\d/:0},d,e,f,g=navigator.mimeTypes,h=navigator.plugins,l=null;if(b.mimes&&g)for(f=a.isArray(b.mimes)?[].concat(b.mimes):a.isString(b.mimes)?[b.mimes]:[],d=0;d<f.length;d++){e=0;try{a.isString(f[d])&&/[^\s]/.test(f[d])&&(e=g[f[d]].enabledPlugin)}catch(n){}if(e&&(e=this.findNavPlugin_(e,c),e.obj&&(l=e.obj),l&&!a.dbug))return l}if(b.plugins&&h){b=a.isArray(b.plugins)?[].concat(b.plugins):a.isString(b.plugins)?[b.plugins]:[];for(d=0;d<b.length;d++){e=0;try{b[d]&&a.isString(b[d])&&(e=h[b[d]])}catch(p){}if(e&&(e=this.findNavPlugin_(e,c),e.obj&&(l=e.obj),l&&!a.dbug))return l}b=h.length;if(a.isNum(b))for(d=0;d<b;d++){e=0;try{e=h[d]}catch(m){}if(e&&(e=this.findNavPlugin_(e,c),e.obj&&(l=e.obj),l&&!a.dbug))break}}}return l},findNavPlugin_:function(a,c){var d=a.description||"",e=a.name||"",f={};if(c.Find.test(d)&&!(c.Find2&&!c.Find2.test(e)||c.Num&&!c.Num.test(RegExp.leftContext+RegExp.rightContext))||c.Find.test(e)&&!(c.Find2&&!c.Find2.test(d)||c.Num&&!c.Num.test(RegExp.leftContext+RegExp.rightContext)))c.Avoid&&(c.Avoid.test(d)||c.Avoid.test(e))||(f.obj=a);return f},getVersionDelimiter:",",findPlugin:function(b){var c,d={status:-3,plugin:0};if(!a.isString(b))return d;if(1==b.length)return this.getVersionDelimiter=b,d;b=b.toLowerCase().replace(/\s/g,"");c=a.Plugins[b];if(!c||!c.getVersion)return d;d.plugin=c;d.status=1;return d}},getPluginFileVersion:function(b,c){var d,e,f,g,h=-1;if(!b)return c;b.version&&(d=a.getNum(b.version+""));if(!d||!c)return c||d||null;d=a.formatNum(d);c=a.formatNum(c);e=c.split(a.splitNumRegx);f=d.split(a.splitNumRegx);for(g=0;g<e.length;g++)if(-1<h&&g>h&&"0"!=e[g]||f[g]!=e[g]&&(-1==h&&(h=g),"0"!=e[g]))return c;return d},AXO:function(){var a;try{a=new window.ActiveXObject}catch(c){}return a?null:window.ActiveXObject}(),getAXO:function(b){var c=null;try{c=new a.AXO(b)}catch(d){}c&&(a.browser.ActiveXEnabled=!0);return c},browser:{},INIT:function(){a.init.library()},init:{hasRun:0,detectIE:function(){var b=a.browser,c=document,d,e=window.navigator?navigator.userAgent||"":"",f,g;b.ActiveXFilteringEnabled=!1;b.ActiveXEnabled=!1;try{b.ActiveXFilteringEnabled=!!window.external.msActiveXFilteringEnabled()}catch(h){}g=["WMPlayer.OCX","ShockwaveFlash.ShockwaveFlash","AgControl.AgControl"];f="Msxml2.XMLHTTP Msxml2.DOMDocument Microsoft.XMLDOM TDCCtl.TDCCtl Shell.UIHelper HtmlDlgSafeHelper.HtmlDlgSafeHelper Scripting.Dictionary".split(" ").concat(g);for(d=0;d<f.length&&(!a.getAXO(f[d])||a.dbug);d++);if(b.ActiveXEnabled&&b.ActiveXFilteringEnabled)for(d=0;d<g.length;d++)if(a.getAXO(g[d])){b.ActiveXFilteringEnabled=!1;break}d=c.documentMode;try{c.documentMode=""}catch(l){}b.isIE=b.ActiveXEnabled||a.isNum(c.documentMode)||eval("/*@cc_on!@*/!1");try{c.documentMode=d}catch(n){}b.verIE=null;b.isIE&&(b.verIE=(a.isNum(c.documentMode)&&7<=c.documentMode?c.documentMode:0)||(/^(?:.*?[^a-zA-Z])??(?:MSIE|rv\s*\:)\s*(\d+\.?\d*)/i.test(e)?parseFloat(RegExp.$1,10):7));},detectNonIE:function(){var b=a.browser,c=window.navigator?navigator:{},d=b.isIE?"":c.userAgent||"",e=c.vendor||"",c=c.product||"";b.isGecko=/Gecko/i.test(c)&&/Gecko\s*\/\s*\d/i.test(d);b.verGecko=b.isGecko?a.formatNum(/rv\s*\:\s*([\.\,\d]+)/i.test(d)?RegExp.$1:"0.9"):null;b.isOpera=/(OPR\s*\/|Opera\s*\/\s*\d.*\s*Version\s*\/|Opera\s*[\/]?)\s*(\d+[\.,\d]*)/i.test(d);b.verOpera=b.isOpera?a.formatNum(RegExp.$2):null;b.isChrome=!b.isOpera&&/(Chrome|CriOS)\s*\/\s*(\d[\d\.]*)/i.test(d);b.verChrome=b.isChrome?a.formatNum(RegExp.$2):null;b.isSafari=!b.isOpera&&!b.isChrome&&(/Apple/i.test(e)||!e)&&/Safari\s*\/\s*(\d[\d\.]*)/i.test(d);b.verSafari=b.isSafari&&/Version\s*\/\s*(\d[\d\.]*)/i.test(d)?a.formatNum(RegExp.$1):null;},detectPlatform:function(){var b,c=window.navigator?navigator.platform||"":"";a.OS=100;if(c){var d=["Win",1,"Mac",2,"Linux",3,"FreeBSD",4,"iPhone",21.1,"iPod",21.2,"iPad",21.3,"Win.*CE",22.1,"Win.*Mobile",22.2,"Pocket\\s*PC",22.3,"",100];for(b=d.length-2;0<=b;b-=2)if(d[b]&&RegExp(d[b],"i").test(c)){a.OS=d[b+1];break}}},library:function(){var b=document;a.head=b.getElementsByTagName("head")[0]||b.getElementsByTagName("body")[0]||b.body||null;this.detectPlatform();this.detectIE();this.detectNonIE();this.hasRun=1;}},isMinVersion:function(b,c,d,e){var f=a.pd.findPlugin(b),g=-1;if(0>f.status)return f.status;f=f.plugin;c=a.formatNum(a.isNum(c)?c.toString():a.isStrNum(c)?a.getNum(c):"0");1!=f.getVersionDone&&(f.getVersion(c,d,e),null===f.getVersionDone&&(f.getVersionDone=1));null!==f.installed&&(g=0.5>=f.installed?f.installed:0.7==f.installed?1:null===f.version?0:0<=a.compareNums(f.version,c,f)?1:-0.1);return g},getVersion:function(b,c,d){var e=a.pd.findPlugin(b);if(0>e.status)return null;e=e.plugin;1!=e.getVersionDone&&(e.getVersion(null,c,d),null===e.getVersionDone&&(e.getVersionDone=1));e=(e=e.version||e.version0)?e.replace(a.splitNumRegx,a.pd.getVersionDelimiter):e;return e},hasMimeType:function(b){if(b&&window.navigator&&navigator.mimeTypes){var c,d,e,f=navigator.mimeTypes,g=a.isArray(b)?[].concat(b):a.isString(b)?[b]:[];e=g.length;for(d=0;d<e;d++){b=0;try{a.isString(g[d])&&/[^\s]/.test(g[d])&&(b=f[g[d]])}catch(h){}if((c=b?b.enabledPlugin:0)&&(c.name||c.description))return b}}return null},Plugins:{}};window[a.name]=a;a.INIT();a.addPlugin("shockwave",{getVersion:function(){var b=null,c;c&&!a.dbug||!this.nav.query().installed||(c=1);b&&!a.dbug||!this.nav.query().version||(b=this.nav.version);c&&!a.dbug||!this.axo.query().installed||(c=1);b&&!a.dbug||!this.axo.query().version||(b=this.axo.version);this.installed=b?1:c?0:-1;this.version=a.formatNum(b)},nav:{hasRun:0,installed:0,version:null,mimeType:"application/x-director",query:function(){var b,c;c=this.hasRun||!a.hasMimeType(this.mimeType);this.hasRun=1;if(c)return this;(c=a.pd.findNavPlugin({find:"Shockwave\\s*for\\s*Director",mimes:this.mimeType,plugins:"Shockwave for Director"}))&&c.description&&(b=a.getNum(c.description+""));b&&(b=a.getPluginFileVersion(c,b));c&&(this.installed=1);b&&(this.version=b);return this}},axo:{hasRun:0,installed:null,version:null,progID:"SWCtl.SWCtl SWCtl.SWCtl.1 SWCtl.SWCtl.7 SWCtl.SWCtl.8 SWCtl.SWCtl.11 SWCtl.SWCtl.12".split(" "),classID:"clsid:166B1BCA-3F9C-11CF-8075-444553540000",query:function(){var b,c,d,e;c=!this.hasRun;this.hasRun=1;if(c){for(c=0;c<this.progID.length;c++)if(b=a.getAXO(this.progID[c])){this.installed=1;e="";try{e=b.ShockwaveVersion("")+""}catch(f){}/(\d[\d\.\,]*)(?:\s*r\s*(\d+))?/i.test(e)&&(b=RegExp.$2,d=a.formatNum(RegExp.$1),b&&(d=d.split(a.splitNumRegx),d[3]=b,d=d.join(",")));if(d&&(this.version=d,!a.dbug))break}}return this}}});})();